## å‡½æ•°å¼ç¼–ç¨‹
ä¸€ã€ åè¯è§£é‡Š 
+ çº¯å‡½æ•°ï¼š
  - å§‹ç»ˆè¿”å›žç›¸åŒçš„å€¼ã€‚
  - è‡ªåŒ…å«
  - ä¸åº”ä¿®æ”¹ç¨‹åºçš„çŠ¶æ€æˆ–å¼•èµ·å‰¯ä½œç”¨  

  æè¿°ï¼šå‡½æ•°å¼ç¼–ç¨‹ä¸­ç›¸åŒçš„è¾“å…¥å§‹ç»ˆæˆ–å¾—ç›¸åŒçš„è¾“å‡ºã€‚å…¶ä¼˜ç‚¹æ–¹ä¾¿æµ‹è¯•ã€å¯ç¼“å­˜å‡½æ•°ã€åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹ä¸éœ€è¦è®¿é—®å…±äº«å†…å­˜æ•°æ®ã€‚
+ å‡½æ•°å¼ç¼–ç¨‹ï¼š ä¸€ç§ç¼–ç¨‹æ€æƒ³ã€èŒƒå¼ï¼ˆç±»ä¼¼è¿˜æœ‰ã€é¢å‘å¯¹è±¡ã€é¢å‘è¿‡ç¨‹ç¼–ç¨‹ï¼‰ï¼Œæ˜¯å¯¹è¿ç®—è¿‡ç¨‹çš„æŠ½è±¡ï¼Œå‡½æ•°å¼ç¼–ç¨‹ä¸­çš„å‡½æ•°æŒ‡çš„æ˜¯æ•°å­¦ä¸­çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯ç¨‹åºä¸­çš„å‡½æ•°ï¼Œå‡½æ•°å¼ç¼–ç¨‹å¿…å®šæ˜¯çº¯å‡½æ•°ã€‚  
+ æŸ¯é‡ŒåŒ–ï¼šå½“ä¸€ä¸ªå‡½æ•°æœ‰å¤šä¸ªå‚æ•°çš„æ—¶å€™ï¼Œå…ˆä¼ é€’ä¸€éƒ¨åˆ†å‚æ•°è°ƒç”¨ä»–ï¼ˆè¿™éƒ¨åˆ†å‚æ•°ä¸ºå›ºå®šå€¼ï¼Œä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼‰ï¼Œç„¶åŽè¿”å›žä¸€ä¸ªæ–°å‡½æ•°ï¼Œå†æŽ¥æ”¶å…¶ä»–å‰©ä½™å¯èƒ½å˜åŒ–çš„å‚æ•°ï¼Œæœ€åŽè¿”å›žç»“æžœã€‚ 
+ å‡½å­ï¼ˆFunctorï¼‰æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå‡½å­æœ¬èº«å…·æœ‰å¯¹å¤–æŽ¥å£ï¼ˆmapæ–¹æ³•ï¼‰ã€‚
  - Pointed å‡½å­ï¼Œå®žçŽ°äº† `of` æ–¹æ³•çš„å‡½å­ã€‚
  - MayBe å‡½å­ï¼Œç”¨äºŽè¿‡æ»¤ç©ºå€¼ï¼Œé¿å…åŽç»­å‡½æ•°æ‰§è¡ŒæŠ¥é”™ã€‚
  - Elther å‡½å­ï¼Œç”¨æ¥å¤„ç†å‡½æ•°æ‰§è¡Œä¸­çš„å¼‚å¸¸ã€‚
  - IO å‡½å­ï¼Œä¸Žå…¶ä»–å‡½å­åŒºåˆ«äºŽ `of` æ–¹æ³•è¿”å›žä¸€ä¸ªå‡½æ•°ï¼ˆåŒºåˆ«å…¶ä»–å‡½å­è¿”å›ž `value` å€¼ï¼‰ï¼Œç”¨äºŽå°è£…éžçº¯å‡½æ•°ï¼Œè®©å…¶åœ¨è°ƒç”¨æ—¶å†æ‰§è¡Œ(æƒ°æ€§æ‰§è¡Œ)ï¼Œä¿è¯å‡½å­ä¹‹é—´çš„çº¯åº¦ã€‚
  - Monand å‡½å­,åŒæ—¶æ‹¥æœ‰ `join` å’Œ `of` ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸”éµå®ˆä¸€äº›å®šå¾‹ï¼ˆæ•°å­¦å®šå¾‹ï¼‰ã€‚ç”¨äºŽè§£å†³å‡½å­åµŒå¥—è°ƒç”¨é—®é¢˜ã€‚

äºŒã€ ç»ƒä¹   
+ [æ¨¡æ‹Ÿ lodash å‡½æ•°](pretend_lodash.js)
+ å‡½æ•°ç¼–ç¨‹  
  - éžçº¯å‡½æ•°  
  ```javascript
    let standard = 18;

    let getResult = age => {
      return age > standard;
    }

    console.log(getResult(20)); // true
  ```

  - çº¯å‡½æ•°  
  ```javascript
    let getResult = (age, standard) => {
      return age > standard;
    }

    console.log(getResult(20, 18)); // true
    console.log(getResult(24, 22)); // true
  ```

  - å‡½æ•°æŸ¯é‡ŒåŒ–  
  ```javascript
    let getResultCurry = (standard) => (age => age > standard);

    let standard18 = getResultCurry(18);
    let standard22 = getResultCurry(22);

    console.log(standard18(20));  // true
    console.log(standard22(25));  // true
  ```

  - é€šè¿‡ lodash curry å‡½æ•°æŸ¯é‡ŒåŒ–  
  ``` javascript
    const _ = require('lodash');

    let getResult = (a, b, c) => {
      return a + b + c;
    }

    let getCurry = _.curry(getResult);
    console.log(getCurry(1)(2)(3));  // 6
    console.log(getCurry(1, 2)(3));  // 6
    let fuc = getCurry(1, 2);
    console.log(fuc(3)); // 6
  ```

  - å®žçŽ° lodash curry å‡½æ•°
  ```javascript
    let getResult = (a, b, c) => {
      return a + b + c;
    }

    const curry = (fn) => {
      const fuc = (...arg) => {
        if (arg.length < fn.length) {
          return (...arg_2) => {
            return fuc(...arg.concat(arg_2));
          }
        }
        return fn(...arg);
      }
      return fuc;
    }

    const curryGetResult = curry(getResult);
    console.log(curryGetResult(1, 2, 3));
    console.log(curryGetResult(1)(2)(3));
    console.log(curryGetResult(1, 2)(3));
  ```

  - ç¼“å­˜å‡½æ•°  
  ```javascript
    let getResult = (r) => {
    console.log('--enter--');
    return Math.PI * r * r;
    }

    let memoize = (fn) => {
      let cache = {};
      return (...arg) => {
        let key = JSON.stringify(arg);
        cache[key] = cache[key] || fn.apply(fn, arg);
        return cache[key];
      }
    }

    let getResultMemory = memoize(getResult);
    console.log(getResultMemory(2));
    console.log(getResultMemory(2));
    console.log(getResultMemory(4));

    // --enter--
    // 12.566370614359172
    // 12.566370614359172
    // --enter--
    // 50.26548245743669
  ```

  - é€šè¿‡ lodash memoize å‡½æ•° ç¼“å­˜
  ```javascript
    let getResult = (r) => {
      console.log('--enter--');
      return Math.PI * r * r;
    }

    const _ = require('lodash');
    let getResultMemory = _.memoize(getResult);
    console.log(getResultMemory(2));
    console.log(getResultMemory(2));
    console.log(getResultMemory(4));

    // --enter--
    // 12.566370614359172
    // 12.566370614359172
    // --enter--
    // 50.26548245743669
  ```

  - é€šè¿‡ lodash flowRight å®žçŽ°å‡½æ•°çš„ç»„åˆ
  ```javascript
    const _ = require('lodash');

    const reverse = arr => arr.reverse();
    const first = arr => arr[0];
    const toUpper = s => s.toUpperCase();

    const f = _.flowRight(toUpper, first, reverse);
    console.log(f(['one', 'two', 'three']));
  ```

  - å®žçŽ° lodash flowRight å‡½æ•°
  ```javascript
    const reverse = arr => arr.reverse();
    const first = arr => arr[0];
    const toUpper = s => s.toUpperCase();

    const flowRight = (...arg) => {
      let index = 0;
      let argRight = arg.reverse();

      const fuc = (value) => {
        let result = argRight[index](value);

        if (index === argRight.length - 1) {
          return result;
        } else {
          index++;
          return fuc(result);
        }
      }
      return fuc;
    }

    const f = flowRight(toUpper, first, reverse);
    console.log(f(['one', 'two', 'three']));
  ```

  - å€ŸåŠ© reduce å®žçŽ° lodash flowRight å‡½æ•°
  ```javascript
    const reverse = arr => arr.reverse();
    const first = arr => arr[0];
    const toUpper = s => s.toUpperCase();

    const flowRight = (...arg) => value => arg.reverse().reduce((memo, item) => item(memo), value);

    const f = flowRight(toUpper, first, reverse);
    console.log(f(['one', 'two', 'three']));
  ```

  - ç»„åˆå‡½æ•°è°ƒè¯•
  ```javascript
    const _ = require('lodash');

    const trace = _.curry((tag, value) => {
      console.log(tag, value);
      return value
    });

    const split = _.curry((rule, str) => _.split(str, rule));
    const join = _.curry((rule, str) => _.join(str, rule));
    const map = _.curry((fn, array) => _.map(array, fn));
    const f = _.flowRight(join('-'), trace('bbb'), map(_.toLower), trace('aaa'), split(' '))
    console.log(f('NEVER SAY DIE'))
  ```

  - lodash fp å‡½æ•°
  ```javascript
    const fp = require('lodash/fp');
    const f = fp.flowRight(fp.join('-'), fp.map(fp.toLower), fp.split(' '))
    console.log(f('NEVER SAY DIE'));
  ```

  - Container (å‡½å­)
  ```javascript
    class Container {
      static of (value) {
        return new Container(value)
      }

      constructor(value) {
        this._value = value
      }

      map (fn) {
        return Container.of(fn(this._value))
      }
    }

    let result = Container.of(5)
      .map(x => x + 2)
      .map(x => x * x)
      .map(console.log)
  ```

  - MayBe å‡½å­
  ```javascript
    class MayBe {
      static of (value) {
        return new MayBe(value);
      }

      constructor(value) {
        return this._value = value;
      }

      isNull () {
        return this._value === null || this._value === undefined
      }

      map (fn) {
        return this.isNull() ? MayBe.of(null) : MayBe.of(fn(this._value));
      }
    }

    let result = MayBe.of("hellow")
      .map(x => x.toUpperCase())
      .map(x => null)
      .map(x => x.split(' '))

    console.log(result);
  ```

  - Either å‡½å­
  ```javascript
    class Right {
      static of (value) {
        return new Right(value);
      }

      constructor(value) {
        this._value = value
      }

      map (fn) {
        return Right.of(fn(this._value))
      }
    }

    class Left {
      static of (value) {
        return new Left(value)
      }

      constructor(value) {
        this._value = value
      }

      map () {
        return this;
      }
    }

    const parseJson = (str) => {
      try {
        return Right.of(str).map(JSON.parse)
      } catch (error) {
        return Left.of({ error: error.message })
      }
    }

    let result = parseJson('{"name": 123}').map(x => x.name + 1);
    console.log(result);
  ```

  - IO å‡½å­
  ```javascript
    const fp = require('lodash/fp')

    class IO {
      static of (value) {
        return new IO(() => {
          return value
        })
      }

      constructor(fn) {
        this._value = fn
      }

      map (fn) {
        return IO.of(fp.flowRight(fn, this._value))
      }
    }

    let result = IO.of(process)
      .map(p => p.execPath)
    console.log(result._value()());
  ```

  - å¤„ç†å‡½æ•°å¼å˜æˆå¼‚æ­¥é—®é¢˜ï¼Œfolktale åº“ task å‡½å­
  ```javascript
    const fs = require('fs')
    const { task } = require('folktale/concurrency/task')
    const { split, find } = require('lodash/fp')

    let readFile = (filename) => {
      return task(({ reject, resolve }) => {
        fs.readFile(filename, 'utf-8', (error, data) => {
          if (error) reject(error)

          resolve(data);
        })
      })
    }

    readFile('package.json')
      .map(split('\n'))
      .map(find(x => x.includes('version')))
      .run()
      .listen({
        onRejected: error => {
          console.log(error);
        },
        onResolved: data => {
          console.log(data);
        }
      })
  ```

  - Monad å‡½å­
  ```javascript
    const fp = require('lodash/fp')
    const fs = require('fs')
    class IO {
      static of (value) {
        return new IO(() => {
          return value
        })
      }

      constructor(fn) {
        this._value = fn
      }

      map (fn) {
        return new IO(fp.flowRight(fn, this._value))
      }

      join () {
        return this._value()
      }

      flatMap (fn) {
        return this.map(fn).join()
      }
    }

    let readFile = (filename) => {
      return IO.of(fs.readFileSync(filename, 'utf-8'))
    }

    let print = (x) => {
      return new IO(() => {
        console.log(x);
        return x;
      });
    }

    // æ³¨æ„ï¼ï¼ï¼IO.of å’Œ new IO åŒºåˆ«äºŽå‚æ•°æŽ¥æ”¶ï¼Œä¸€ä¸ªéœ€è¦å€¼ï¼Œä¸€ä¸ªéœ€è¦æ–¹æ³•ã€‚
    readFile('package.json')
      .map(fp.toUpper)
      .flatMap(print)
      .join()
  ```

  - Lodash shortcut fusion ï¼ˆåˆå¹¶é“¾å¼è¿­ä»£å™¨ï¼Œæé«˜æ‰§è¡Œæ•ˆçŽ‡ï¼‰  
    > åœ¨ lodash ä¸­ï¼Œåªæœ‰éƒ¨åˆ†æ–¹æ³•åœ¨é“¾å¼è°ƒç”¨çš„æ—¶å€™æ”¯æŒ shortcut fusion, æ–‡æ¡£åŽŸæ–‡å¦‚ä¸‹
    > The wrapper methods that support shortcut fusion are:
    > at,Â compact,Â drop,Â dropRight,Â dropWhile,Â filter,Â find,Â findLast,Â head,Â initial,Â last,map,Â reject,Â reverse,Â slice,Â tail,Â take,Â takeRight,Â takeRightWhile,Â takeWhile, andÂ toArray
    + ä½¿ç”¨æ–‡æ¡£ä¸­æåˆ°çš„ `take` æ–¹æ³•ç¤ºä¾‹
    ```javascript
    // ä½¿ç”¨æ–‡æ¡£ä¸­æåˆ°çš„ take æ–¹æ³•ç¤ºä¾‹
    const _ = require('lodash')

    let array = [
      { name: 'jack', age: 22 },
      { name: 'tom', age: 32 },
      { name: 'son', age: 17 },
      { name: 'tony', age: 66 }
    ]

    const result = _
      .chain(array)
      .filter(({ age }) => {
        console.log('filter methond')
        return age > 18
      })
      .take(2)
      .value()

    console.log(result)
    // è¿­ä»£å™¨å·²è¢«ä¼˜åŒ–ï¼Œfilteræ–¹æ³•åªå¾ªçŽ¯äº†2æ¬¡ï¼Œ
    // ç»“æžœå¦‚ä¸‹ :
    // filter methond
    // filter methond
    // [ { name: 'jack', age: 22 }, { name: 'tom', age: 32 } ]
    ```
    + å¦ä¸€ç§åœºæ™¯ä¸ºï¼ˆåªä¸ºä¸¾ä¾‹ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª map å¾ªçŽ¯é‡Œå¹²2ä»¶äº‹ï¼Œå…ˆæŠŠæ¯æ¬¡å¾ªçŽ¯å¯¹è±¡å¢žåŠ ä¸€ä¸ªå±žæ€§ï¼Œå†åˆ é™¤å¾ªçŽ¯å¯¹è±¡çš„æŸä¸€ä¸ªå±žæ€§ã€‚
    ```javascript
    // å¯èƒ½ä¼šè¿™æ ·å†™
    .map(item => {
      // 1.å¤„ç†ç¬¬ä¸€ä»¶äº‹
      // 2.å¤„ç†ç¬¬äºŒä»¶äº‹
      // ...
      // 10.å¤„ç†ç¬¬åä»¶äº‹
    })

    // ä¸Šè¾¹çš„å†™æ³•ï¼Œä¸€ä¸ªå‡½æ•°å¤„ç†äº†å¤šä»¶äº‹ï¼Œå‡½æ•°å˜çš„æ¯”è¾ƒå¤æ‚ï¼Œå¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§éƒ½ç›¸å¯¹è¾ƒä½Žï¼Œæˆ‘ä»¬å…¶å®žæƒ³é€šè¿‡é“¾å¼è°ƒç”¨è¿™ä¹ˆå†™
    .map(item => {
      // 1.å¤„ç†ç¬¬ä¸€ä»¶äº‹
    })
    .map(item => {
      // 2.å¤„ç†ç¬¬äºŒä»¶äº‹
    })
    // ...
    .map(item => {
      //10.å¤„ç†ç¬¬åä»¶äº‹
    })
    // ä¸Šè¾¹çš„æ–¹æ³•å‘çŽ° lodash å¹¶æ²¡æœ‰å¸®åŠ©æˆ‘ä»¬åˆå¹¶è¿­ä»£å™¨ï¼Œoh~noðŸ˜…ï¼ï¼ï¼

    // æœ€åŽï¼Œæ­£ç¡®âœ…çš„å†™æ³•åº”è¯¥ç±»ä¼¼è¿™æ ·ï¼ŒæŠŠæ¯ä¸€ä»¶éœ€è¦åœ¨ map å‡½æ•°ä¸­å¤„ç†çš„äº‹æƒ…ï¼Œå•ç‹¬å†™æˆä¸€ä¸ªä¸ªå‡½æ•°ï¼Œç„¶åŽé€šè¿‡ lodash fp æ¨¡å—æä¾›çš„ flow æ–¹æ³•ï¼Œåˆå¹¶æ‰§è¡Œã€‚
    const _ = require('lodash')
    const fp = require('lodash/fp')

    let array = [
      { name: 'jack', age: 22 },
      { name: 'tom', age: 32 },
      { name: 'son', age: 17 },
      { name: 'tony', age: 66 }
    ]

    const addClass = item => {
      console.log('function-2')
      return Object.assign(item, { class: 'A' })
    }

    const removeAge = (person) => {
      console.log('function-3')
      let { age, ...arg } = person
      return arg
    }

    const result = _
      .chain(array)
      .filter(({ age }) => {
        console.log('function-1')
        return age > 18
      })
      .map(fp.flow(addClass, removeAge))
      .value()

    console.log(result)
    // map method 1 å’Œ map method 2 äº¤æ›¿æ‰§è¡Œ
    // ç»“æžœå¦‚ä¸‹ï¼š
    // filter method
    // filter method
    // filter method
    // filter method
    // map method 1
    // map method 2
    // map method 1
    // map method 2
    // map method 1
    // map method 2
    // [{ name: 'jack', class: 'A' },{ name: 'tom', class: 'A' },{ name: 'tony', class: 'A' }]
    ```