# 组件开发
+ ## 安装工具
  ```
    yarn global add @vue/cli
    yarn global add @vue/cli-service-global
  ```
  > `@vue/cli-service-global` 为 `vue` 提供的原型快速开发工具
+ ## 启动命令
  ```js
    vue serve
    // 或
    vue serve 具体文件
  ```
  > 如果 `vue serve` 不指定文件，默认会执行根目录加的 `main.js`, `index.js`, `App.vue`, `app.vue`

+ ## 开发模式
  组件库如果支持按需导入和全部导入，需要在组件库开发的时候选择以下两种开发方式其中一种
  - 介绍
    + Multirepo (Multiple Repository)
      - 每一个模块/包对应一个项目
    + **Monorepo** (Monolithic Repository)
      - **一个项目管理多个模块/包**
    >  一般选择 `Monorepo`
  - 手动创建目录
    ```js
      ── packages
         ├── input
         │   ├── __test__
         │   ├── dist
         │   ├── src
         │   ├── stories
         │   ├── index.js
         │   ├── LICENSE
         │   ├── package.json
         │   └── README.md  
         │ 
         └── // 省略其他组件 .....

             .
    ```
    > `packages` 文件夹创建在项目根目录，是存放所有组件的文件夹
    > `button` 目录为存放 `button` 组件相关文件的目录，此目录是用户自定义的名字，需命名为你开发组件的名称。
    > `stories` 文件夹存储后面介绍的 storybook 相关文件 

+ ## 组件开发
  - 创建组件源码文件
    + `src` 文件夹下创建 `input.vue` 文件
  - 组件编码
    ```js
      <template>
        <div>
          <input v-bind="$attrs" :type="type" :value="value" @input="handleInput">
        </div>
      </template>

      <script>
        export default {
          name: 'myInput',
          inheritAttrs: false,
          props: {
            value: {
              type: String
            },
            type: {
              type: String,
              default: 'text'
            }
          },
          methods: {
            handleInput (evt) {
              this.$emit('input', evt.target.value)
              const findParent = parent => {
                while (parent) {
                  if (parent.$options.name === 'MyFormItem') {
                    break
                  } else {
                    parent = parent.$parent
                  }
                }
                return parent
              }
              const parent = findParent(this.$parent)
              if (parent) {
                parent.$emit('validate')
              }
            }
          }
        }
      </script>
      <style>

      </style>
    ```
  - 入口文件 `index,js` 编码
    ```js
      import MyInput from './src/input.vue'

      MyInput.install = Vue => {
        Vue.component(MyInput.name, MyInput)
      }

      export default MyInput
    ```
+ ## storybook
  - 介绍
    + 可视化的组件展示平台
    + 在隔离的开发环境下，以交互的方式展示组件
    + `storybook` 在主程序之外运行，固可独立开发组件，不必担心依赖关系问题
  - 安装
    + 进入到项目文件夹
      `cd myComponent`
    + 初始化
      `npx -p @storybook/cli sb init --type vue`
      > 这里使用 npx 安装是避免全局安装 `storybook cli` 工具，你也可以全局安装
    + 安装依赖  
      `yarn add vue`  
      `yarn add vue-loader vue-template-compiler --dev`
      > 推荐使用 yarn 安装，因为后边还会用到 yarn 的 workspace 功能。
  - 命令
    + 启动  
    `yarn storybook`
    + 打包
    `yarn build-storybook`
  - 修改配置文件  
    + 将根目录 `.storybook/main.js` 中的 `stories` 属性，改为 `['../packages/**/*.stories.js']`
  - 编码
    + 在 `stories` 文件夹下创建 `input.stories.js` 文件。
      > 注意，该文件结尾必须是 `.stories.js`
    + 编码
      ```js
        import MyInput from '../'

        export default {
          title: 'MyInput',
          component: MyInput
        }

        export const Text = () => ({
          components: { MyInput },
          template: '<my-input v-model="value"></my-input>',
          data () {
            return {
              value: '请输入'
            }
          }
        })

        export const Password = () => ({
          components: { MyInput },
          template: '<my-input type="password" v-model="value"></my-input>',
          data () {
            return {
              value: '请输入'
            }
          }
        })
      ```
  